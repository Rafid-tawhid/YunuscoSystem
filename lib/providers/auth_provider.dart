import 'dart:convert';import 'package:flutter/material.dart';import 'package:http/http.dart' as http;import 'package:shared_preferences/shared_preferences.dart';import 'package:yunusco_group/helper_class/dashboard_helpers.dart';import 'package:yunusco_group/models/home_menu_model.dart';import 'package:yunusco_group/service_class/api_services.dart';import 'package:yunusco_group/utils/constants.dart';import '../models/user_model.dart';import '../screens/home_page.dart';class AuthProvider with ChangeNotifier {  UserModel? _user;  bool _isLoading = false;  UserModel? get user => _user;  bool get isLoading => _isLoading;  bool get isAuthenticated => _user != null;  // ðŸ“Œ Load User from Shared Preferences  Future<void> loadUser() async {    _user = await DashboardHelpers.getUser();    notifyListeners();  }  List<String> loginModules=[];  // ðŸ“Œ Login API Call  Future<bool> login(String email, String password) async {    _isLoading = true;    notifyListeners();    ApiService apiService = ApiService();    //   "username":"Samin",    //       "password":"Abc@#\$02"    var response = await apiService.postData('api/Accounts/GetUserLogin', {"username": email, "password": password});    if (response != null) {      loginModules.clear();      _user = UserModel.fromJson(response['returnvalue']['login']);      for(var i in response['returnvalue']['result']){        loginModules.add(i['ModuleId'].toString());      }      DashboardHelpers.currentUser = _user;      await DashboardHelpers.saveUser(_user!);      DashboardHelpers.setToken(response['token'] ?? '');      _isLoading = false;      debugPrint('loginModules ${loginModules.length}');      DashboardHelpers.saveUserModules('roles',loginModules);      notifyListeners();      return true;    }    //    else {      _isLoading = false;      notifyListeners();      return false;    }  }  //  //Management Assistant at Vorer Bangla (Online News Paper) 2020  //Danesh Money Exchange (Online transaction) 2023  //  // ðŸ“Œ Logout  Future<void> logout() async {    await DashboardHelpers.clearUser();    _user = null;    AppConstants.token = '';    notifyListeners();  }  void setIsLoading(bool val) {    _isLoading = val;    notifyListeners();  }  List<Menu> menuList = [];  Future<void> getMenuList() async {    final pref = await SharedPreferences.getInstance();    final roleStrings = pref.getStringList('roles') ?? [];    // Convert roles to a Set of ints for faster lookup    final roleIds = roleStrings.map(int.parse).toSet();    menuList = fullModuleList        .where((e) => roleIds.contains(e.id))        .map((e) => Menu(e.id, e.icon, e.title, false))        .toList();    notifyListeners();  }}var fullModuleList = [  Menu(5, 'assets/images/purchase.png', 'Purchasing', false), // ID 5 from table  Menu(15, 'assets/images/management.png', 'Management', false), // ID 15  Menu(1, 'assets/images/hrbold.png', 'HR & Payroll', false), // ID 1  Menu(4, 'assets/images/button-merch.png', 'Merchandising', false), // ID 4  Menu(6, 'assets/images/planbold.png', 'Planning', false), // ID 6  Menu(7, 'assets/images/prodbold.png', 'IE', false), // Changed to ID 7, name to 'IE'  Menu(8, 'assets/images/prodbold.png', 'Cutting', false), // New for ID 8  Menu(9, 'assets/images/prodbold.png', 'Sewing', false), // New for ID 9  Menu(10, 'assets/images/prodbold.png', 'Finishing', false), // New for ID 10  Menu(11, 'assets/images/INVENTORY-min.png', 'Inventory', false), // ID 11  Menu(2, 'assets/images/ATTENDANCE-min.png', 'Accounts', false), // ID 2  Menu(12, 'assets/images/button-exim.png', 'Export Import', false), // ID 12  Menu(13, 'assets/images/button-trims.png', 'Trims Sales', false), // Changed to ID 13, name to 'Trims Sales'  Menu(14, 'assets/images/button-sec.png', 'Settings', false), // ID 14  Menu(3, 'assets/images/button-trims.png', 'Sample', false),  Menu(0, 'assets/images/ATTENDANCE-min.png', 'Profile', false), // Added ID 3 'Sample'// Removed 'Notifications' and 'Profile' as they weren't in the module table];// menus = [//   Menu(44, 'assets/images/purchase.png', 'Purchasing', false),//   Menu(6, 'assets/images/management.png', 'Management', false),//   Menu(45, 'assets/images/button-trims.png', 'Notifications', false),//   Menu(1, 'assets/images/button-merch.png', 'Merchandising', false),//   Menu(1, 'assets/images/planbold.png', 'Planning', false),//   Menu(44, 'assets/images/prodbold.png', 'Production', false),//   Menu(6, 'assets/images/INVENTORY-min.png', 'Inventory', false),//   Menu(45, 'assets/images/ATTENDANCE-min.png', 'Accounts', false),//   Menu(1, 'assets/images/hrbold.png', 'HR & Payroll', false),//   Menu(1, 'assets/images/ATTENDANCE-min.png', 'Profile', false),//   Menu(1, 'assets/images/button-sec.png', 'Settings', false),//   Menu(1, 'assets/images/button-exim.png', 'Export Import', false),// ];